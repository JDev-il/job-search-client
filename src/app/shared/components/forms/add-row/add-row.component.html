<form [formGroup]="newAddRowForm" (submit)="formSubmit()">
  <ng-content></ng-content>
  <mat-form-field appearance="outline">
    <mat-label>Status</mat-label>
    <mat-select formControlName="status">
      <mat-option>None</mat-option>
      @for (status of statuses(); track status) {
      <mat-option [value]="status">{{ status }}</mat-option>
      }
    </mat-select>
  </mat-form-field>

  <mat-form-field appearance="outline">
    <mat-label>Company Name</mat-label>
    <input
      matInput
      formControlName="companyName"
      placeholder="Name of company you applied to?"
    />
  </mat-form-field>

  <mat-form-field appearance="outline">
    <mat-label>Company Location</mat-label>
    <input
      (keyup)="onTypeCountry($event)"
      type="text"
      placeholder="Company Location"
      matInput
      formControlName="companyLocation"
      [matAutocomplete]="auto"
    />
    <mat-autocomplete #auto="matAutocomplete">
      @for (country of filteredCountries(); track country) {
      <mat-option
        [value]="country.name.common | stringSanitizer"
        (onSelectionChange)="onSelectCountry(country.name.common)"
      >
        {{ country.name.common | stringSanitizer }}
      </mat-option>
      }
    </mat-autocomplete>
  </mat-form-field>
  @if (isCompanyCity()) {
  <mat-form-field appearance="outline">
    <input
      (keyup)="onTypeCity($event)"
      type="text"
      placeholder="Which City?"
      matInput
      formControlName="companyCity"
      [matAutocomplete]="auto"
    />
    <mat-autocomplete #auto="matAutocomplete" (optionSelected)="onSelectCity()">
      @for (city of filteredCities(); track city) {
      <mat-option
        [value]="city.city | stringSanitizer"
      >
        {{ city.city | stringSanitizer }}
      </mat-option>
      }
    </mat-autocomplete>
  </mat-form-field>
  <mat-form-field appearance="outline">
    <mat-label>Position Type</mat-label>
    <mat-select formControlName="positionType">
      @for (positionType of positionTypes(); track positionType) {
      <mat-option [value]="positionType">{{ positionType }}</mat-option>
      }
    </mat-select>
  </mat-form-field>
  } @else { @if(!isCompanyCity() && isCompanyLoction()){
  <app-spinner [isSmallSpinner]="true"></app-spinner>
  } }
  <mat-form-field appearance="outline">
    <mat-label>Position Stacks</mat-label>
    <mat-select multiple formControlName="positionStack">
      @for (positionStack of positionStacks(); track positionStack) {
      <mat-option [value]="positionStack">{{ positionStack }}</mat-option>
      }
    </mat-select>
  </mat-form-field>

  <mat-form-field appearance="outline">
    <mat-label>Application Platform</mat-label>
    <mat-select formControlName="applicationPlatform">
      @for (platform of applicationPlatform(); track platform) {
      <mat-option [value]="platform">{{ platform }}</mat-option>
      }
    </mat-select>
  </mat-form-field>

  <mat-form-field appearance="outline">
    <mat-label>Date Applied</mat-label>
    <input
      matInput
      [matDatepicker]="picker"
      formControlName="applicationDate"
    />
    <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
    <mat-datepicker #picker></mat-datepicker>
  </mat-form-field>

  <mat-form-field appearance="outline">
    <mat-label>My Hunch</mat-label>
    <input matInput formControlName="hunch" />
  </mat-form-field>

  <mat-form-field appearance="outline">
    <mat-label>Any Notes?</mat-label>
    <input matInput formControlName="notes" />
  </mat-form-field>
</form>
